rating: 2126  
from: biweekly contest 107 Q3

quickly thought of the solution: dp  
many details  
have to be very careful