rating: 1904  
from: contest 394 Q3

immediately thought of the solution: preprocess + dp  
solved without too much effort 

bug: index